Options -Indexes
DirectoryIndex index.html
RewriteEngine On

# Force HTTPS (Handles Load Balancers/Proxies)
RewriteCond %{HTTPS} off
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Ensure trailing slashes
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*[^/])$ /$1/ [L,R=301]

# Custom Redirects (Consolidated to RewriteRules)
RewriteRule ^features/prayer-wall/?$ /features/prayer-requests/ [L,R=301]
RewriteRule ^privacy-policy/?$ /privacy/ [L,R=301]
RewriteRule ^contact-us/?$ /contact/ [L,R=301]

# Orientation Migration (Bypass legacy welcome loops)
RewriteRule ^welcome/?$ /orientation/ [L,R=301]
RewriteRule ^welcome-1/?$ /orientation/ [L,R=301]

# Legacy Traffic Preservation (From Analytics)
RewriteRule ^church-app/check-ins/?$ /features/check-ins/ [L,R=301]
RewriteRule ^church-app/giving/?$ /features/giving/ [L,R=301]
RewriteRule ^pricing/check-ins-app/?$ /pricing/ [L,R=301]

# Handle login paths
RewriteRule ^sign-in/?$ /login/ [L,R=301]

# Error Handling
ErrorDocument 404 /index.html
